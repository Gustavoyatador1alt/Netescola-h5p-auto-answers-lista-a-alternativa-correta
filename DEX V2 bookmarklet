javascript:(function(){'use strict';const clean=e=>String(e||"").replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/\s+/g," ").trim(),tryParse=e=>{try{return"string"==typeof e?JSON.parse(e):e}catch{return null}},pullParams=(e={})=>e.params&&
(e.params.answers||e.params.question)?e.params:e,normalize=e=>String(e||"").toLowerCase().replace(/\s+/g," ").trim();function createBox(e=document){if(e.getElementById("h5p-box"))return e.getElementById("h5p-box");const t=e.createElement("div");t.id="h5p-box",t.style.position="fixed",t.style.top="60px",t.style.left="20px",t.style.minWidth="250px",t.style.maxWidth="400px",t.style.background="#2c3e50",t.style.color="white",t.style.border="2px solid #34495e",t.style.borderRadius="8px",t.style.padding="8px 12px",t.style.fontSize="13px",t.style.lineHeight="1.4",t.style.zIndex="999999",t.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)",t.innerHTML="<b>‚úÖ H5P:</b><br><i>Aguardando...</i>",e.body.appendChild(t),makeDraggable(t);return t}function makeDraggable(e){let t=0,o=0,n=0,r=0;e.onmousedown=function(e){e.preventDefault(),n=e.clientX,r=e.clientY,document.onmouseup=closeDragElement,document.onmousemove=elementDrag};function elementDrag(a){a.preventDefault();const i=n-a.clientX,l=r-a.clientY;n=a.clientX,r=a.clientY,e.style.top=e.offsetTop-l+"px",e.style.left=e.offsetLeft-i+"px"}function closeDragElement(){document.onmouseup=null,document.onmousemove=null}}function extractRows(e=document){const t=[];const o=e=>{const n=pullParams(e||{}),r=clean(n.question||n.prompt||n.stem||n.title||""),a=Array.isArray(n.answers)?n.answers:[];a.forEach((e,o)=>{const a=e.correct===!0||e.isCorrect===!0||e.correctAnswer===!0;t.push({question:r,idx:o,letter:String.fromCharCode(65+o),text:clean(e.text||e.label||e.content||""),correct:a})})};const n=e.defaultView?.H5PIntegration;if(n?.contents)Object.values(n.contents).forEach(e=>{const n=String(e.library||"").split(" ")[0];if("H5P.MultiChoice"===n){const r=tryParse(e.jsonContent)||e.content||tryParse(e.params)||null;o(r)}});const r=e.defaultView?.H5P;if(r&&Array.isArray(r.instances))r.instances.forEach(e=>{const n=e.libraryInfo?.machineName||e.library?.machineName||e?.constructor?.name;"H5P.MultiChoice"===n&&o(e.options||e.params||e.contentData?.params||{})});return t}function autoAnswer(e,t=document){const o=e.filter(e=>e.correct),n=t.querySelectorAll(".h5p-answer, .h5p-multi-choice-answer");o.forEach(e=>{n.forEach(t=>{const n=(t.innerText||t.textContent||"").trim();(normalize(n)===normalize(e.text)||n.includes(e.text))&&!t.classList.contains("answered")&&(t.click(),t.classList.add("answered"),console.log("üü¢ Marcando:",n))})});const r=t.querySelector(".h5p-question-check-answer, .h5p-multi-choice-submit");r&&!r.disabled&&r.click()}function responded(e=document){return!e.querySelector(".h5p-question-check-answer, .h5p-multi-choice-submit")}function autoClickNext(e=document){if(!responded(e))return;const t=e.querySelector("button.nui-button.nui-button-medium.nui-button-curved.nui-button-solid.nui-button-primary");t&&!t.disabled&&(console.log("‚ñ∂Ô∏è Clicando no bot√£o Avan√ßar"),t.click())}function clickInitialAdvance(e=document){const t=e.querySelector("button.nui-button.nui-button-medium.nui-button-curved.nui-button-solid.nui-button-primary");if(t&&!t.disabled)return console.log("‚ñ∂Ô∏è Clicando no bot√£o inicial Avan√ßar"),t.click(),!0;return!1}function refresh(e=document){if(clickInitialAdvance(e))return;const t=extractRows(e);if(!t.length){const o=createBox(e);o.innerHTML="<b>‚úÖ H5P:</b><br><i>Nada encontrado.</i>";return}autoAnswer(t,e),setTimeout(()=>autoClickNext(e),1500);const o=createBox(e);let n="<b>‚úÖ H5P:</b><br><table style='width:100%; font-size:12px;'>";t.forEach(e=>{n+=`<tr><td>${e.correct?"‚úÖ":"‚ùå"}</td><td>${e.letter}</td><td>${e.text}</td></tr>`}),n+="</table>",o.innerHTML=n}function scanIframe(){document.querySelectorAll("iframe").forEach(e=>{try{const t=e.contentDocument;if(!t)return;refresh(t),t.addEventListener("DOMContentLoaded",()=>refresh(t)),console.log("üîÑ Injetado em iframe (same-origin)")}catch(e){console.warn("‚ö†Ô∏è Iframe bloqueado por CORS:",e)}})}function init(){console.log("üß† Script H5P ativo em:",location.href),refresh(document),setInterval(()=>refresh(document),2e3),setInterval(scanIframe,3e3)}init()})();
